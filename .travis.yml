os: linux
dist: bionic
group: dev

services:
  - podman

before_install:
  # Zainstaluj Podman jeśli jeszcze nie jest zainstalowany
  - sudo apt-get update
  - sudo apt-get install -y podman || true

script:
  # Sprawdź wersję Podman
  - echo "==== SPRAWDZENIE INSTALACJI PODMAN ===="
  - which podman || echo "Podman nie jest dostępny w PATH"
  - podman --version || echo "Komenda podman --version zwróciła błąd"
  
  # Sprawdź status usług Podman
  - echo "==== SPRAWDZENIE STATUSU USŁUG PODMAN ===="
  - sudo systemctl status podman.service || echo "Usługa podman.service niedostępna lub nie działa"
  - sudo systemctl status podman.socket || echo "Usługa podman.socket niedostępna lub nie działa"
  - sudo systemctl is-active podman.service || echo "Usługa podman.service nie jest aktywna"
  - sudo systemctl is-active podman.socket || echo "Usługa podman.socket nie jest aktywna"
  - sudo systemctl is-enabled podman.service || echo "Usługa podman.service nie jest włączona"
  - sudo systemctl is-enabled podman.socket || echo "Usługa podman.socket nie jest włączona"
  
  # Sprawdź, czy demony systemd dla Podman są uruchomione
  - echo "==== PROCESY PODMAN ===="
  - ps aux | grep -i podman || echo "Brak procesów Podman"
  
  # Sprawdź dzienniki systemowe związane z Podman
  - echo "==== LOGI PODMAN ===="
  - sudo journalctl -u podman.service --no-pager -n 20 || echo "Brak logów podman.service"
  - sudo journalctl -u podman.socket --no-pager -n 20 || echo "Brak logów podman.socket"
