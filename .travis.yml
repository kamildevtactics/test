jobs:
  include:
  - dist: jammy
  - dist: bionic
  - dist: focal
  - dist: noble

services:
- postgresql

addons:
  postgresql: '16'
  apt:
    packages:
    - postgresql-16
    - postgresql-client-16
    - postgresql-server-dev-16
    - postgresql-16-postgis-3
    - postgresql-16-postgis-3-scripts

script:
 - psql --version
 - sudo systemctl status postgresql@16-main || true
 - sudo journalctl -u postgresql@16-main --no-pager | tail -n 100 || true
 - sudo ls -la /var/lib/postgresql/16/main/ || true
 - sudo ls -la /etc/postgresql/16/main/ || true
 - sudo cat /etc/postgresql/16/main/postgresql.conf | grep -E 'port|listen|data_directory' || true
 - sudo pg_lsclusters || true
 - sudo systemctl list-units | grep postgres || true
 - sudo du -sh /var/lib/postgresql/15/main/ || true
 - df -h || true
 - sudo netstat -tulpn | grep 5433 || true
 - sudo ps aux | grep postgres || true
 - sudo PGPASSWORD=postgres psql -U postgres -h localhost -p 5433 -c "SELECT version();" || true

