dist: bionic

group: dev

before_install:
  - sudo apt-get update
  - sudo apt-get install -y unzip
  - export ANDROID_SDK_ROOT=/usr/local/android-sdk
  - export CMDLINE_TOOLS_PATH=$ANDROID_SDK_ROOT/cmdline-tools/latest
  - export SDKMANAGER_BIN=$CMDLINE_TOOLS_PATH/bin/sdkmanager
  - mkdir -p $CMDLINE_TOOLS_PATH
  - wget -q -O /tmp/android-sdk.zip "https://dl.google.com/android/repository/commandlinetools-linux-6609375_latest.zip"
  - if [ -f /tmp/android-sdk.zip ]; then echo "✅ Android SDK downloaded"; else echo "❌ Failed to download Android SDK" && exit 1; fi
  - unzip -q /tmp/android-sdk.zip -d $CMDLINE_TOOLS_PATH && mv $CMDLINE_TOOLS_PATH/cmdline-tools $CMDLINE_TOOLS_PATH/latest
  - chmod -R a+rX $ANDROID_SDK_ROOT/*
  - if [ -f "$SDKMANAGER_BIN" ]; then echo "✅ sdkmanager found"; else echo "❌ sdkmanager not found" && exit 1; fi
  - yes | $SDKMANAGER_BIN --install "platform-tools" "platforms;android-30" "build-tools;30.0.3" --sdk_root=$ANDROID_SDK_ROOT

script:
  - java -version
  - $SDKMANAGER_BIN --list
